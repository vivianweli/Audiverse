<h1>
  <label>Audio List</label>
</h1>

<!-- Search Bar -->
<div class="search-bar">
  <label for="search-input">Search by Title:</label>
  <input type="text" id="search-input" onkeyup="searchByTitle()" placeholder="Search for audio..." />
</div>

<!-- Tag Filter -->
<div class="filter">
  <label for="tag-filter">Filter by tag:</label>
  <select id="tag-filter" onchange="filterByTag()">
    <option value="all" <%= selectedTag === 'all' ? 'selected' : '' %>>All</option>
    <% tags.forEach(tag => { %>
      <option value="<%= tag %>" <%= selectedTag === tag ? 'selected' : '' %>><%= tag %></option>
    <% }); %>
  </select>
</div>

<!-- Audio List -->
<div id="audio-list" >
  <% if (sounds.length === 0) { %>
    <p>No audio available for this tag.</p>
  <% } else { %>
    <% sounds.forEach(audio => { %>
      <div class="audio-item" data-title="<%= audio.title.toLowerCase() %>" data-id="<%= audio.id %>">
        <h2><a href="/sound/<%= audio.id %>" onclick="event.preventDefault();"><%= audio.title %></a></h2>
        <p class="tags">
          <% if (!audio.tags || audio.tags === '') { %>
            No tags
          <% } else if (Array.isArray(audio.tags)) { %>
            Tags: <%= audio.tags.join(', ') %>
          <% } else { %>
            Tag: <%= audio.tags %>
          <% } %>
        </p>
        <p>Uploader: <%= audio.uploader %> </p>
      </div>
    <% }); %>
  <% } %>
</div>

<!-- Pagination Controls -->
<div class="pagination">
  <% if (currentPage > 1) { %>
    <a href="?page=<%= currentPage - 1 %>&tag=<%= selectedTag %>">Previous</a>
  <% } %>

  <span>Page <%= currentPage %> of <%= totalPages %></span>

  <% if (currentPage < totalPages) { %>
    <a href="?page=<%= currentPage + 1 %>&tag=<%= selectedTag %>">Next</a>
  <% } %>
</div>

<script>
  // Handle filtering based on tag selection
  function filterByTag() {
    const selectedTag = document.getElementById('tag-filter').value;
    window.location.href = `?page=1&tag=${selectedTag}`;  // Reset to page 1 and apply the selected tag
  }

  // Handle search by title
  function searchByTitle() {
    const searchQuery = document.getElementById('search-input').value.toLowerCase();
    const audioItems = document.querySelectorAll('.audio-item');

    audioItems.forEach(item => {
      const title = item.getAttribute('data-title');
      if (title.includes(searchQuery)) {
        item.style.display = ''; // Show item if title matches search
      } else {
        item.style.display = 'none'; // Hide item if title doesn't match search
      }
    });
  }
  const currentRoute = '/';
  const filteredSounds = <%- JSON.stringify(sounds) %>;
</script>


<!-- haha -->